---
title: "Page 3 (Distances)"
author: "Jonathan Molner & Diya Shreenath"
date: "11/1/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


```{r}
library(tidyverse)
```


```{r}
distance_data <- read_csv("~/march-madness-predictor/data/Bio 185 March Madness Data Lats.csv")
```

```{r}
view(distance_data)
```

```{r}
haversine <- function(long1, lat1, long2, lat2, round = 3) {
  # convert to radians
  long1 = long1 * pi / 180
  lat1  = lat1  * pi / 180
  long2 = long2 * pi / 180
  lat2  = lat2  * pi / 180
  
  R = 6371 # Earth mean radius in km
  
  a = sin((lat2 - lat1)/2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1)/2)^2
  d = R * 2 * asin(sqrt(a))
  
  return( round(d,round) ) # distance in km
}
```


```{r}
distance_data <- distance_data %>%
  mutate(distance = haversine(College_lon, College_lat, `Lon for City Where Game was Played`, `Lat for City Where Game was played`, round = 0))
```

```{r}
distance_data %>%
  mutate(College_lon)
```

```{r}
distance_data <- distance_data %>%
  mutate(distance_underdog = haversine(Underdog_lon, Underdog_lat, `Lon for City Where Game was Played`, `Lat for City Where Game was played`, round = 0))
```

```{r}
distance_data <- distance_data %>%
  select(Year, Favorite, distance, Round, `Favorite (Seed)`)
```

```{r}
distance_data %>%
  group_by(Favorite, Year) %>%
  mutate(total_distance = sum(distance))
```

